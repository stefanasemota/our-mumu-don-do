/**
 * Core Philosophy:
 * This ruleset enforces a strict read-only model for all client-side requests.
 * All educational content is considered public and can be read by any user,
 * whether authenticated or anonymous. All write operations (create, update, delete)
 * are explicitly disabled, reflecting a security model where data is managed
 * exclusively by a trusted backend service or admin script, not by end-users.
 *
 * Data Structure:
 * The data is organized into a single top-level collection:
 * - /weeklyEducationalTopics/{weeklyEducationalTopicId}: Stores the educational
 *   content, including denormalized story pages.
 *
 * Key Security Decisions:
 * - Public Read Access: All documents in the `weeklyEducationalTopics` collection
 *   are publicly readable to support the application's content delivery function.
 * - Client Writes Disabled: To protect the integrity of the educational content,
 *   all write operations from the client are denied. This is the most secure
 *   posture when the provided application description indicates content management
 *   happens through a backend process (e.g., via an ADMIN_PASSWORD), which
 *   would use Admin SDKs to bypass these rules.
 *
 * Denormalization for Authorization:
 * The data model denormalizes story pages directly into the topic documents.
 * Since the access model is simple (public read), no specific denormalization
 * is required for authorization checks.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description
     *   Allows public, read-only access to all weekly educational topics. All
     *   write operations are disabled to ensure content is only managed by a
     *   trusted backend service.
     * @path
     *   /weeklyEducationalTopics/{weeklyEducationalTopicId}
     * @allow
     *   An anonymous user reading a specific educational topic document.
     *   Example: `(get) /weeklyEducationalTopics/some-topic-id`
     * @deny
     *   Any user, signed-in or not, attempting to create a new topic.
     *   Example: `(create) /weeklyEducationalTopics/new-topic`
     * @principle
     *   Protects data integrity by enforcing a read-only model on the client,
     *   assuming a trusted backend environment for all data mutations.
     */
    match /weeklyEducationalTopics/{weeklyEducationalTopicId} {
      // READ: Anyone can read the educational topics and list them.
      allow get: if true;
      allow list: if true;

      // WRITE: No client-side writes are allowed. Content is managed server-side.
      allow create: if false;
      allow update: if false;
      allow delete: if false;
    }
  }
}